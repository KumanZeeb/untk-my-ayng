<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üé¨ For My Ayang üíñ</title>
    
    <!-- SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Dancing+Script:wght@700&family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --pink-light: #ffb6c1;
            --pink-medium: #ff69b4;
            --pink-dark: #ff1493;
            --purple-light: #d8bfd8;
            --purple-medium: #9370db;
            --white: #ffffff;
            --black: #1a1a2e;
            --gradient: linear-gradient(135deg, #ffb6c1 0%, #ff69b4 50%, #9370db 100%);
            --gradient-dark: linear-gradient(135deg, #ff1493 0%, #8a2be2 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Quicksand', sans-serif;
            background: var(--gradient);
            min-height: 100vh;
            color: var(--black);
            overflow-x: hidden;
            padding: 15px;
            padding-bottom: 80px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* Header */
        .header {
            text-align: center;
            padding: 20px 15px;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 3px solid var(--pink-medium);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            opacity: 0.3;
            z-index: 0;
        }
        
        .header h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 2.8rem;
            color: var(--pink-dark);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: 1.1rem;
            color: #666;
            position: relative;
            z-index: 1;
        }
        
        .love-icon {
            color: var(--pink-dark);
            margin: 0 5px;
            animation: heartbeat 1.5s infinite;
        }
        
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* Video Container */
        .video-wrapper {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border: 3px solid var(--purple-light);
            position: relative;
            overflow: hidden;
        }
        
        .video-wrapper::after {
            content: '‚ú®';
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.5rem;
            animation: sparkle 2s infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        .video-container {
            position: relative;
            padding-top: 56.25%; /* 16:9 Aspect Ratio */
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 15px;
        }
        
        /* Controls */
        .controls {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            border: 3px solid var(--pink-light);
        }
        
        .control-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            font-family: 'Quicksand', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: var(--gradient-dark);
            color: white;
            flex: 1;
            min-width: 120px;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(0, 0, 0, 0.15);
        }
        
        .btn-secondary {
            background: white;
            color: var(--pink-dark);
            border: 2px solid var(--pink-light);
        }
        
        .btn-secondary:hover {
            background: var(--pink-light);
            color: white;
        }
        
        .select-wrapper {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        select {
            flex: 1;
            padding: 12px 15px;
            border-radius: 50px;
            border: 2px solid var(--purple-light);
            background: white;
            font-family: 'Quicksand', sans-serif;
            font-weight: 500;
            color: var(--black);
            font-size: 1rem;
            outline: none;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        
        select:focus {
            border-color: var(--purple-medium);
        }
        
        /* Episode List */
        .episode-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            border: 3px solid var(--purple-light);
        }
        
        .episode-section h3 {
            font-family: 'Poppins', sans-serif;
            color: var(--pink-dark);
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .episode-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            gap: 10px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.7);
        }
        
        .episode-btn {
            padding: 12px 5px;
            background: white;
            border: 2px solid var(--pink-light);
            border-radius: 15px;
            color: var(--pink-dark);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 50px;
        }
        
        .episode-btn:hover {
            background: var(--pink-light);
            color: white;
            transform: translateY(-3px);
        }
        
        .episode-btn.active {
            background: var(--gradient-dark);
            color: white;
            border-color: var(--pink-dark);
            box-shadow: 0 5px 15px rgba(255, 20, 147, 0.3);
        }
        
        /* Loading */
        .loading {
            text-align: center;
            padding: 30px;
            color: var(--pink-dark);
            font-size: 1.2rem;
        }
        
        .loading i {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
            animation: spin 1.5s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Floating Hearts */
        .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        
        .heart {
            position: absolute;
            color: rgba(255, 105, 180, 0.3);
            font-size: 20px;
            animation: float 15s infinite linear;
        }
        
        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        
        /* Responsive */
        @media (max-width: 600px) {
            .header h1 {
                font-size: 2.2rem;
            }
            
            .control-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .select-wrapper {
                flex-direction: column;
            }
            
            .episode-grid {
                grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            }
            
            body {
                padding: 10px;
                padding-bottom: 100px;
            }
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--pink-medium);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--pink-dark);
        }
        
        /* Hide video controls on mobile */
        @media (hover: none) {
            video::-webkit-media-controls {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Floating Hearts Background -->
    <div class="floating-hearts" id="heartsContainer"></div>
    
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>For My Ayang <i class="fas fa-heart love-icon"></i></h1>
            <p id="seriesTitle">Loading your movie...</p>
        </div>
        
        <!-- Video Player -->
        <div class="video-wrapper">
            <div class="video-container">
                <div class="loading" id="loading">
                    <i class="fas fa-heartbeat"></i>
                    Loading your special video...
                </div>
                <video id="videoPlayer" controls crossorigin="anonymous" style="display: none;">
                    Your browser does not support the video tag.
                </video>
            </div>
        </div>
        
        <!-- Controls -->
        <div class="controls">
            <div class="control-group">
                <button class="btn btn-primary" onclick="prevEpisode()">
                    <i class="fas fa-chevron-left"></i> Prev
                </button>
                <button class="btn btn-primary" onclick="nextEpisode()">
                    Next <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
            <div class="select-wrapper">
                <select id="episodeSelect" onchange="changeEpisode(this.value)">
                    <option value="0">Select Episode</option>
                </select>
                
                <select id="qualitySelect" onchange="changeQuality()">
                    <option value="0">Quality 1</option>
                    <option value="1">Quality 2</option>
                    <option value="2">Quality 3</option>
                </select>
            </div>
            
            <div style="text-align: center; margin-top: 15px;">
                <button class="btn btn-secondary" onclick="loadCurrentVideo()">
                    <i class="fas fa-redo"></i> Reload Video
                </button>
            </div>
        </div>
        
        <!-- Episode List -->
        <div class="episode-section">
            <h3><i class="fas fa-list"></i> Episodes</h3>
            <div class="episode-grid" id="episodeList">
                <!-- Episode buttons will be added here -->
            </div>
        </div>
    </div>
    
    <!-- SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- HLS.js for HLS streaming -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.0/dist/hls.min.js"></script>
    
    <script>
        // =================== AUTO-DETECT BASE URL ===================
        const getBaseUrl = () => {
            // Auto detect base URL dari current location
            const baseUrl = window.location.origin;
            console.log('Base URL detected:', baseUrl);
            return baseUrl;
        };
        
        // Helper function untuk API calls
        const apiCall = async (path, params = {}) => {
            try {
                const baseUrl = getBaseUrl();
                const url = new URL(`${baseUrl}/api/drakorkita/${path}`);
                
                // Add query parameters
                Object.keys(params).forEach(key => {
                    if (params[key] !== undefined && params[key] !== null) {
                        url.searchParams.append(key, params[key]);
                    }
                });
                
                console.log('API call to:', url.toString());
                
                const response = await fetch(url.toString());
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return await response.json();
            } catch (error) {
                console.error('API call error:', error);
                throw error;
            }
        };
        
        // =================== FLOATING HEARTS ===================
        function createFloatingHearts() {
            const container = document.getElementById('heartsContainer');
            for (let i = 0; i < 15; i++) {
                const heart = document.createElement('div');
                heart.className = 'heart';
                heart.innerHTML = '‚ù§Ô∏è';
                heart.style.left = `${Math.random() * 100}%`;
                heart.style.animationDuration = `${15 + Math.random() * 10}s`;
                heart.style.animationDelay = `${Math.random() * 5}s`;
                heart.style.fontSize = `${15 + Math.random() * 15}px`;
                container.appendChild(heart);
            }
        }
        
        // =================== ROMANTIC POPUPS ===================
        function showRomanticPopups() {
            // First popup
            Swal.fire({
                title: 'Halooo ayang acuwww üíñ',
                html: 'Maapinn aku yaww, moga ini bisa bikin kamu maapin aku hehe üòò',
                icon: 'info',
                background: 'linear-gradient(135deg, #ffb6c1 0%, #ff69b4 100%)',
                color: '#fff',
                confirmButtonText: 'Iyaa sayang ‚ù§Ô∏è',
                confirmButtonColor: '#ff1493',
                showClass: {
                    popup: 'animate__animated animate__heartBeat'
                },
                customClass: {
                    title: 'romantic-title',
                    htmlContainer: 'romantic-text'
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    // Second popup
                    setTimeout(() => {
                        Swal.fire({
                            title: 'Selamatt nontonn cintahhh üé¨üíï',
                            html: 'Love youuuuuu~ üòç‚ú®',
                            icon: 'success',
                            background: 'linear-gradient(135deg, #9370db 0%, #ff69b4 100%)',
                            color: '#fff',
                            confirmButtonText: 'Aku jugaa sayang! üíñ',
                            confirmButtonColor: '#9370db',
                            showClass: {
                                popup: 'animate__animated animate__tada'
                            }
                        });
                    }, 800);
                }
            });
        }
        
        // =================== MAIN LOGIC ===================
        // Get URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const endpoint = urlParams.get('endpoint') || 'taxi-driver-2025-v1cy';
        let currentEpisode = 0;
        let currentQuality = 0;
        let episodesData = [];
        let hlsPlayer = null;
        
        // Load series data
        async function loadSeriesData() {
            try {
                document.getElementById('seriesTitle').textContent = 'Loading...';
                
                // PAKAI API CALL HELPER
                const data = await apiCall(`detail/${endpoint}`);
                
                if (data.message === 'success') {
                    document.getElementById('seriesTitle').textContent = data.data.title;
                    episodesData = data.data.episodes;
                    updateEpisodeList();
                    updateEpisodeSelect();
                    loadVideo(currentEpisode, currentQuality);
                } else {
                    document.getElementById('seriesTitle').textContent = 'Series not found';
                    Swal.fire({
                        title: 'Series Not Found',
                        text: 'Please check the series endpoint.',
                        icon: 'warning',
                        confirmButtonText: 'OK'
                    });
                }
            } catch (error) {
                console.error('Error loading series:', error);
                document.getElementById('seriesTitle').textContent = 'Error loading series';
                Swal.fire({
                    title: 'Connection Error!',
                    html: `
                        <p>Failed to load series data.</p>
                        <p><strong>Possible issues:</strong></p>
                        <ul style="text-align: left;">
                            <li>Check your internet connection</li>
                            <li>API server might be down</li>
                            <li>Wrong endpoint format</li>
                        </ul>
                        <p>Current URL: ${getBaseUrl()}</p>
                    `,
                    icon: 'error',
                    confirmButtonText: 'Retry',
                    showCancelButton: true,
                    cancelButtonText: 'Cancel'
                }).then((result) => {
                    if (result.isConfirmed) {
                        loadSeriesData(); // Retry
                    }
                });
            }
        }
        
        // Update episode list UI
        function updateEpisodeList() {
            const container = document.getElementById('episodeList');
            container.innerHTML = '';
            
            episodesData.forEach((ep, index) => {
                const btn = document.createElement('button');
                btn.className = 'episode-btn';
                if (index === currentEpisode) btn.classList.add('active');
                btn.textContent = index + 1;
                btn.onclick = () => {
                    currentEpisode = index;
                    loadVideo(currentEpisode, currentQuality);
                    updateEpisodeList();
                    updateEpisodeSelect();
                };
                container.appendChild(btn);
            });
        }
        
        // Update episode dropdown
        function updateEpisodeSelect() {
            const select = document.getElementById('episodeSelect');
            select.innerHTML = '<option value="0">Select Episode</option>';
            
            episodesData.forEach((ep, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `Episode ${index + 1}`;
                if (index === currentEpisode) option.selected = true;
                select.appendChild(option);
            });
        }
        
        // Load and play video
        async function loadVideo(episodeIndex, qualityIndex) {
            try {
                // Show loading
                document.getElementById('loading').style.display = 'block';
                document.getElementById('videoPlayer').style.display = 'none';
                
                // Update active episode
                currentEpisode = episodeIndex;
                updateEpisodeList();
                updateEpisodeSelect();
                
                // PAKAI API CALL HELPER untuk get video URL
                const data = await apiCall(`video/${endpoint}`, {
                    episode: episodeIndex,
                    resolution: qualityIndex
                });
                
                if (data.success) {
                    const video = document.getElementById('videoPlayer');
                    const videoUrl = data.data.video_url;
                    
                    console.log('Video URL received:', videoUrl);
                    
                    // Destroy previous HLS instance if exists
                    if (hlsPlayer) {
                        hlsPlayer.destroy();
                    }
                    
                    // Check if video is HLS
                    if (videoUrl.includes('.m3u8')) {
                        if (Hls.isSupported()) {
                            // Use HLS.js
                            hlsPlayer = new Hls();
                            hlsPlayer.loadSource(videoUrl);
                            hlsPlayer.attachMedia(video);
                            hlsPlayer.on(Hls.Events.MANIFEST_PARSED, () => {
                                hideLoadingAndPlay(video);
                            });
                            
                            // Error handling for HLS
                            hlsPlayer.on(Hls.Events.ERROR, (event, data) => {
                                console.error('HLS error:', data);
                                if (data.fatal) {
                                    switch(data.type) {
                                        case Hls.ErrorTypes.NETWORK_ERROR:
                                            Swal.fire({
                                                title: 'Network Error',
                                                text: 'Failed to load video stream. Please check your connection.',
                                                icon: 'error'
                                            });
                                            break;
                                        case Hls.ErrorTypes.MEDIA_ERROR:
                                            hlsPlayer.recoverMediaError();
                                            break;
                                        default:
                                            hlsPlayer.destroy();
                                            Swal.fire({
                                                title: 'Playback Error',
                                                text: 'Failed to play video. Try another quality.',
                                                icon: 'error'
                                            });
                                            break;
                                    }
                                }
                            });
                        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                            // Safari native HLS support
                            video.src = videoUrl;
                            hideLoadingAndPlay(video);
                        } else {
                            throw new Error('HLS not supported in this browser');
                        }
                    } else {
                        // Regular video file
                        video.src = videoUrl;
                        hideLoadingAndPlay(video);
                    }
                    
                    // Update quality select
                    updateQualitySelect(episodeIndex);
                    
                } else {
                    throw new Error(data.error || 'Failed to get video URL');
                }
            } catch (error) {
                console.error('Error loading video:', error);
                document.getElementById('loading').innerHTML = '<i class="fas fa-exclamation-triangle"></i> Error loading video';
                
                Swal.fire({
                    title: 'Video Error!',
                    html: `
                        <p>Failed to load video.</p>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p>Try:</p>
                        <ul style="text-align: left;">
                            <li>Reloading the page</li>
                            <li>Checking your connection</li>
                            <li>Trying another episode</li>
                        </ul>
                    `,
                    icon: 'error',
                    confirmButtonText: 'Retry',
                    cancelButtonText: 'Cancel',
                    showCancelButton: true
                }).then((result) => {
                    if (result.isConfirmed) {
                        loadVideo(currentEpisode, currentQuality); // Retry
                    }
                });
            }
        }
        
        function hideLoadingAndPlay(video) {
            document.getElementById('loading').style.display = 'none';
            video.style.display = 'block';
            video.play().catch(e => {
                console.log('Autoplay prevented:', e);
                Swal.fire({
                    title: 'Click to Play üíñ',
                    text: 'Tap the play button to start watching your special video',
                    icon: 'info',
                    confirmButtonText: 'OK',
                    background: 'linear-gradient(135deg, #ffb6c1 0%, #ff69b4 100%)',
                    color: '#fff'
                });
            });
        }
        
        // Update quality options
        function updateQualitySelect(episodeIndex) {
            const select = document.getElementById('qualitySelect');
            const episode = episodesData[episodeIndex];
            
            if (episode && episode.resolutions) {
                select.innerHTML = '';
                episode.resolutions.forEach((res, index) => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = `Quality ${index + 1}`;
                    if (index === currentQuality) option.selected = true;
                    select.appendChild(option);
                });
            }
        }
        
        // =================== NAVIGATION FUNCTIONS ===================
        function prevEpisode() {
            if (currentEpisode > 0) {
                currentEpisode--;
                loadVideo(currentEpisode, currentQuality);
            }
        }
        
        function nextEpisode() {
            if (currentEpisode < episodesData.length - 1) {
                currentEpisode++;
                loadVideo(currentEpisode, currentQuality);
            }
        }
        
        function changeEpisode(episodeIndex) {
            currentEpisode = parseInt(episodeIndex);
            loadVideo(currentEpisode, currentQuality);
        }
        
        function changeQuality() {
            currentQuality = parseInt(document.getElementById('qualitySelect').value);
            loadVideo(currentEpisode, currentQuality);
        }
        
        function loadCurrentVideo() {
            loadVideo(currentEpisode, currentQuality);
        }
        
        // =================== KEYBOARD SHORTCUTS ===================
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowLeft':
                    prevEpisode();
                    break;
                case 'ArrowRight':
                    nextEpisode();
                    break;
                case ' ':
                    const video = document.getElementById('videoPlayer');
                    if (video.paused) video.play();
                    else video.pause();
                    e.preventDefault();
                    break;
                case 'f':
                case 'F':
                    if (document.fullscreenElement) {
                        document.exitFullscreen();
                    } else {
                        document.getElementById('videoPlayer').requestFullscreen();
                    }
                    break;
            }
        });
        
        // =================== INITIALIZATION ===================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Player initialized with endpoint:', endpoint);
            console.log('Base URL:', getBaseUrl());
            
            // Create floating hearts
            createFloatingHearts();
            
            // Show romantic popups
            setTimeout(() => {
                showRomanticPopups();
            }, 1000);
            
            // Load series data
            loadSeriesData();
            
            // Update quality select on change
            document.getElementById('qualitySelect').onchange = changeQuality;
            
            // Add sweet alert styles
            const style = document.createElement('style');
            style.textContent = `
                .romantic-title {
                    font-family: 'Dancing Script', cursive !important;
                    font-size: 2.5rem !important;
                }
                .romantic-text {
                    font-family: 'Quicksand', sans-serif !important;
                    font-size: 1.2rem !important;
                }
                .swal2-popup {
                    border-radius: 25px !important;
                    border: 3px solid #ff69b4 !important;
                }
            `;
            document.head.appendChild(style);
            
            // Log untuk debugging
            console.log('API Base URL:', getBaseUrl() + '/api/drakorkita');
        });
        
        // =================== MOBILE TOUCH SUPPORT ===================
        let touchStartX = 0;
        let touchEndX = 0;
        
        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        });
        
        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });
        
        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // Swipe left - next episode
                    nextEpisode();
                    Swal.fire({
                        title: 'Next Episode ‚û°Ô∏è',
                        text: 'Loading next episode...',
                        icon: 'info',
                        timer: 1000,
                        showConfirmButton: false
                    });
                } else {
                    // Swipe right - previous episode
                    prevEpisode();
                    Swal.fire({
                        title: 'Previous Episode ‚¨ÖÔ∏è',
                        text: 'Loading previous episode...',
                        icon: 'info',
                        timer: 1000,
                        showConfirmButton: false
                    });
                }
            }
        }
        
        // =================== CONNECTION MONITORING ===================
        window.addEventListener('online', () => {
            console.log('Connection restored');
            Swal.fire({
                title: 'Connection Restored ‚úÖ',
                text: 'You are back online!',
                icon: 'success',
                timer: 2000,
                showConfirmButton: false
            });
        });
        
        window.addEventListener('offline', () => {
            console.log('Connection lost');
            Swal.fire({
                title: 'Connection Lost üì∂',
                text: 'Please check your internet connection',
                icon: 'warning',
                timer: 3000,
                showConfirmButton: false
            });
        });
    </script>
</body>
</html>